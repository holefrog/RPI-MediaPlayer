![Logo](logo.png)

# ğŸµ RPI MediaPlayer

å°† Raspberry Pi æ‰“é€ ä¸ºä¸“ä¸šçº§å¤šéŸ³æºåª’ä½“æ’­æ”¾å™¨ï¼Œæ”¯æŒ **Logitech Media Server (LMS)**ã€**AirPlay 2** å’Œ **è“ç‰™éŸ³é¢‘**ï¼Œé…å¤‡ **OLED å®æ—¶æ˜¾ç¤ºå±**ã€‚

---

## âœ¨ æ ¸å¿ƒç‰¹æ€§

### ğŸ¼ ä¸‰éŸ³æºæ— ç¼åˆ‡æ¢
- **ğŸ¹ Squeezelite** - è¿æ¥ Logitech Media Serverï¼Œæ’­æ”¾æœ¬åœ°éŸ³ä¹åº“
- **ğŸ“± AirPlay 2** - ä» iPhone/iPad/Mac æ¨é€éŸ³é¢‘
- **ğŸ”µ è“ç‰™éŸ³ç®±** - æ¥æ”¶ä»»ä½•è“ç‰™è®¾å¤‡çš„éŸ³é¢‘æµ

### ğŸ–¥ï¸ æ™ºèƒ½ OLED æ˜¾ç¤º
- ğŸ“Š å®æ—¶æ˜¾ç¤ºå½“å‰éŸ³æºï¼ˆSQ/AP/BTï¼‰
- ğŸ¨ è‰ºæœ¯å®¶ã€æ›²ç›®ä¿¡æ¯è‡ªåŠ¨æ»šåŠ¨
- ğŸ”Š éŸ³é‡è°ƒèŠ‚æ—¶å¼¹çª—æ˜¾ç¤º
- ğŸ’¤ æ™ºèƒ½å±ä¿ï¼ˆ5ç§’æš—å±ï¼Œ15åˆ†é’Ÿå…³é—­ï¼‰

### ğŸ”Š ä¸“ä¸šéŸ³é¢‘å¤„ç†
- **PipeWire** - ç°ä»£éŸ³é¢‘æœåŠ¡å™¨
- **WM8960 å£°å¡** - é«˜ä¿çœŸè¾“å‡º
- ğŸšï¸ éŸ³æºä¼˜å…ˆçº§è‡ªåŠ¨ç®¡ç†
- ğŸ›ï¸ ç‹¬ç«‹éŸ³é‡æ§åˆ¶

### ğŸš€ å…¨è‡ªåŠ¨éƒ¨ç½²
- âš¡ ä¸€é”®å®‰è£…è„šæœ¬
- ğŸ”„ æ™ºèƒ½ä¸¤é˜¶æ®µéƒ¨ç½²
- ğŸ”Œ ç¡¬ä»¶é©±åŠ¨è‡ªåŠ¨åŠ è½½
- âœ… æœåŠ¡è‡ªåŠ¨å¯åŠ¨å’ŒéªŒè¯

---

## ğŸ§© ç¡¬ä»¶éœ€æ±‚

| ç»„ä»¶ | æ¨èå‹å· | å¿…éœ€ |
|------|---------|:----:|
| **ä¸»æ¿** | Raspberry Pi 4B (4GB) | âœ… |
| **å£°å¡** | Waveshare WM8960 Audio Board | âœ… |
| **æ˜¾ç¤ºå±** | SSD1306 OLED (128x64, I2C) | â­• |
| **ç”µæº** | 5V 3A USB-C | âœ… |
| **å­˜å‚¨** | microSD å¡ (16GB+) | âœ… |

> **âš ï¸ é‡è¦æç¤ºï¼š**
> - WM8960 æ˜¯ **Sound Board**ï¼Œä¸æ˜¯ Audio HATï¼Œæ¥çº¿æ–¹å¼ä¸åŒ
> - OLED ä½¿ç”¨ GPIO æ¨¡æ‹Ÿ I2Cï¼ˆI2C-3ï¼‰ï¼Œä¸å ç”¨æ ‡å‡† I2C æ€»çº¿
> - è¯¦ç»†æ¥çº¿å›¾è¯·å‚è§ [`documents/HW_WM8960.md`](documents/HW_WM8960.md) å’Œ [`documents/HW_SSD1306.md`](documents/HW_SSD1306.md)

---

## ğŸ’½ æ“ä½œç³»ç»Ÿ

**æ¨èï¼šRaspberry Pi OS Trixie (64-bit)** æˆ– **Bookworm (64-bit)**

> **âš ï¸ é‡è¦ï¼š** Trixie/Bookworm ä¸å†æ”¯æŒ `wpa_supplicant.conf` é…ç½® WiFi  
> å¿…é¡»ä½¿ç”¨ **Raspberry Pi Imager** çš„é¢„é…ç½®åŠŸèƒ½

ğŸ“– è¯¦ç»†æ— å¤´å®‰è£…æ­¥éª¤ï¼š[`documents/RPI_HEADLESS_SETUP.md`](documents/RPI_HEADLESS_SETUP.md)

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
RPI-MediaPlayer/
â”œâ”€â”€ ğŸ“„ config.ini              # ä¸»é…ç½®æ–‡ä»¶ï¼ˆSSHã€éŸ³æºã€ç¡¬ä»¶å‚æ•°ï¼‰
â”œâ”€â”€ ğŸš€ setup.sh                # æœ¬åœ°éƒ¨ç½²è„šæœ¬ï¼ˆå…¥å£ï¼‰
â”œâ”€â”€ ğŸ”§ stage_1.sh              # é˜¶æ®µ1ï¼šç³»ç»Ÿå’Œç¡¬ä»¶é©±åŠ¨
â”œâ”€â”€ ğŸ”§ stage_2.sh              # é˜¶æ®µ2ï¼šæœåŠ¡å®‰è£…
â”‚
â”œâ”€â”€ ğŸ“š lib/                    # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ env.sh                 # ç¯å¢ƒåˆå§‹åŒ–å’Œè·¯å¾„ç®¡ç†
â”‚   â”œâ”€â”€ utils.sh               # å·¥å…·å‡½æ•°ï¼ˆæ—¥å¿—ã€é…ç½®ã€æœåŠ¡ç®¡ç†ï¼‰
â”‚   â”œâ”€â”€ local_utils.sh         # æœ¬åœ°è„šæœ¬å·¥å…·åº“
â”‚   â””â”€â”€ monitor.sh             # è¿œç¨‹æœåŠ¡ç›‘æ§è„šæœ¬
â”‚
â”œâ”€â”€ ğŸ§© modules/                # å®‰è£…æ¨¡å—ï¼ˆæŒ‰é¡ºåºæ‰§è¡Œï¼‰
â”‚   â”œâ”€â”€ 01-system.sh           # ç³»ç»Ÿé…ç½®ï¼ˆæ—¶åŒºã€localeã€ç¡¬ä»¶é©±åŠ¨ï¼‰
â”‚   â”œâ”€â”€ 02-pipewire.sh         # PipeWire éŸ³é¢‘æœåŠ¡å™¨
â”‚   â”œâ”€â”€ 03-volume.sh           # éŸ³é‡æ§åˆ¶
â”‚   â”œâ”€â”€ 04-squeezelite.sh      # LMS æ’­æ”¾å™¨
â”‚   â”œâ”€â”€ 05-oled.sh             # OLED æ˜¾ç¤ºå±
â”‚   â”œâ”€â”€ 06-airplay.sh          # AirPlay æ¥æ”¶å™¨
â”‚   â””â”€â”€ 07-bluetooth.sh        # è“ç‰™éŸ³é¢‘
â”‚
â”œâ”€â”€ ğŸ“‹ templates/              # é…ç½®å’Œè„šæœ¬æ¨¡æ¿
â”‚   â”œâ”€â”€ configs/               # æœåŠ¡é…ç½®æ–‡ä»¶
â”‚   â”‚   â”œâ”€â”€ bluetooth-main.conf.template
â”‚   â”‚   â”œâ”€â”€ oled.ini.template
â”‚   â”‚   â”œâ”€â”€ shairport-sync.conf.template
â”‚   â”‚   â””â”€â”€ wireplumber-bluetooth.conf.template
â”‚   â”œâ”€â”€ scripts/               # å¯åŠ¨è„šæœ¬
â”‚   â”‚   â”œâ”€â”€ bluetooth-a2dp-autopair.sh.template
â”‚   â”‚   â”œâ”€â”€ check_services.sh.template
â”‚   â”‚   â”œâ”€â”€ oled_test.py.template
â”‚   â”‚   â”œâ”€â”€ squeezelite.sh.template
â”‚   â”‚   â””â”€â”€ volume.sh.template
â”‚   â””â”€â”€ services/              # Systemd æœåŠ¡å•å…ƒ
â”‚       â”œâ”€â”€ bluetooth-a2dp-autopair.service.template
â”‚       â”œâ”€â”€ oled.service.template
â”‚       â”œâ”€â”€ shairport-sync.service.template
â”‚       â”œâ”€â”€ squeezelite.service.template
â”‚       â””â”€â”€ volume.service.template
â”‚
â”œâ”€â”€ ğŸ¨ resources/              # åº”ç”¨èµ„æº
â”‚   â””â”€â”€ oled/                  # OLED Python åº”ç”¨
â”‚       â”œâ”€â”€ main.py            # ä¸»å¾ªç¯
â”‚       â”œâ”€â”€ config.py          # é…ç½®è¯»å–
â”‚       â”œâ”€â”€ display.py         # æ˜¾ç¤ºæ§åˆ¶
â”‚       â”œâ”€â”€ query.py           # éŸ³æºçŠ¶æ€æŸ¥è¯¢
â”‚       â”œâ”€â”€ screensaver.py     # å±ä¿ç®¡ç†
â”‚       â”œâ”€â”€ state_handlers.py  # çŠ¶æ€å¤„ç†å™¨
â”‚       â””â”€â”€ msyh.ttf           # ä¸­æ–‡å­—ä½“
â”‚
â””â”€â”€ ğŸ“– documents/              # æ–‡æ¡£
    â”œâ”€â”€ TROUBLESHOOTING.md     # æ•…éšœæ’æŸ¥æŒ‡å—
    â”œâ”€â”€ BLUETOOTH_TIPS.md      # è“ç‰™é…å¯¹ç­–ç•¥
    â”œâ”€â”€ HW_WM8960.md           # WM8960 æ¥çº¿å’ŒéªŒè¯
    â”œâ”€â”€ HW_SSD1306.md          # OLED æ¥çº¿å’Œé…ç½®
    â”œâ”€â”€ RPI_HEADLESS_SETUP.md  # æ— å¤´å®‰è£…æ•™ç¨‹
    â””â”€â”€ RPI_SSH_KEY_GEN.md     # SSH å¯†é’¥é…ç½®
```

---

## ğŸ”„ éƒ¨ç½²æµç¨‹

### ğŸ“‹ éƒ¨ç½²æ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                  æœ¬åœ°ç”µè„‘ (setup.sh)                     â”‚
â”‚  1. âœ… éªŒè¯æœ¬åœ°æ–‡ä»¶                                       â”‚
â”‚  2. ğŸ“¤ ä¸Šä¼ æ–‡ä»¶åˆ°æ ‘è“æ´¾                                   â”‚
â”‚  3. ğŸš€ æ‰§è¡Œè¿œç¨‹å®‰è£…è„šæœ¬                                   â”‚
â”‚  4. ğŸ”„ ç®¡ç†ä¸¤æ¬¡é‡å¯                                       â”‚
â”‚  5. âœ”ï¸  éªŒè¯æœåŠ¡çŠ¶æ€                                      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ ‘è“æ´¾ - é˜¶æ®µ 1 (stage_1.sh)                  â”‚
â”‚  â€¢ â° é…ç½®æ—¶åŒºå’Œ locale                                   â”‚
â”‚  â€¢ âš™ï¸  ä¿®æ”¹ /boot/firmware/config.txt                    â”‚
â”‚    - å¯ç”¨ I2C (WM8960, OLED)                            â”‚
â”‚    - åŠ è½½ WM8960 é©±åŠ¨ (dtoverlay=wm8960-soundcard)      â”‚
â”‚    - å¯ç”¨ GPIO æ¨¡æ‹Ÿ I2C (dtoverlay=i2c-gpio)            â”‚
â”‚  â€¢ ğŸ”„ è‡ªåŠ¨é‡å¯ï¼ˆåŠ è½½å†…æ ¸æ¨¡å—ï¼‰                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚            æ ‘è“æ´¾ - é˜¶æ®µ 2 (stage_2.sh)                  â”‚
â”‚  1. ğŸ” éªŒè¯ç¡¬ä»¶ï¼ˆWM8960 å£°å¡ã€OLED I2C è®¾å¤‡ï¼‰             â”‚
â”‚  2. ğŸµ å®‰è£… PipeWire éŸ³é¢‘æœåŠ¡å™¨                          â”‚
â”‚  3. ğŸ”Š é…ç½®éŸ³é‡æ§åˆ¶ï¼ˆWM8960 ç¡¬ä»¶ + PipeWire è½¯ä»¶ï¼‰        â”‚
â”‚  4. ğŸ¹ å®‰è£… Squeezeliteï¼ˆç”Ÿæˆè™šæ‹Ÿ MAC åœ°å€ï¼‰             â”‚
â”‚  5. ğŸ–¥ï¸  éƒ¨ç½² OLED æ˜¾ç¤ºåº”ç”¨ï¼ˆPython è™šæ‹Ÿç¯å¢ƒï¼‰            â”‚
â”‚  6. ğŸ“± é…ç½® AirPlay (Shairport-Sync + metadata ç®¡é“)    â”‚
â”‚  7. ğŸ”µ è®¾ç½®è“ç‰™è‡ªåŠ¨é…å¯¹ï¼ˆNoInputNoOutput ä»£ç†ï¼‰          â”‚
â”‚  â€¢ ğŸ”„ æœ€ç»ˆé‡å¯ï¼ˆç¡®ä¿æ‰€æœ‰æœåŠ¡å®Œå…¨å°±ç»ªï¼‰                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ğŸ”‘ å…³é”®è®¾è®¡å†³ç­–

#### ğŸ”„ ä¸¤æ¬¡é‡å¯çš„å¿…è¦æ€§
- **ç¬¬ä¸€æ¬¡é‡å¯**ï¼šåŠ è½½ç¡¬ä»¶é©±åŠ¨ï¼ˆdtoverlay éœ€è¦å†…æ ¸é‡æ–°åˆå§‹åŒ–ï¼‰
- **ç¬¬äºŒæ¬¡é‡å¯**ï¼šç¡®ä¿æ‰€æœ‰ç”¨æˆ·æœåŠ¡åœ¨æ­£ç¡®çš„è¿è¡Œæ—¶ç¯å¢ƒä¸­å¯åŠ¨

#### ğŸšï¸ éŸ³é‡åˆ†å±‚æ§åˆ¶
- **ç¡¬ä»¶å±‚ï¼ˆWM8960ï¼‰**ï¼šå›ºå®š 95%ï¼Œé˜²æ­¢å¤±çœŸ
- **è½¯ä»¶å±‚ï¼ˆPipeWireï¼‰**ï¼š100% é»˜è®¤ï¼Œç”¨æˆ·å¯è°ƒ
- **åº”ç”¨å±‚ï¼ˆAirPlay/è“ç‰™ï¼‰**ï¼šå„è‡ªç‹¬ç«‹çš„éŸ³é‡æ§åˆ¶

#### ğŸµ éŸ³æºä¼˜å…ˆçº§åˆ¤æ–­
- æ£€æŸ¥ PipeWire `sink-inputs` çš„ `corked` çŠ¶æ€
- `corked: no` = æ­£åœ¨æ’­æ”¾ï¼Œ`corked: yes` = å·²æš‚åœ
- **ä¼˜å…ˆçº§**ï¼šAirPlay > è“ç‰™ > Squeezelite

#### ğŸ” å®‰å…¨æœºåˆ¶
- SSH å¯†é’¥æƒé™å¼ºåˆ¶éªŒè¯ï¼ˆ600ï¼‰
- è“ç‰™ PIN æ–‡ä»¶æƒé™ä¿æŠ¤ï¼ˆ600ï¼‰
- AirPlay metadata ç®¡é“æƒé™é™åˆ¶ï¼ˆ664ï¼‰

---

## âš™ï¸ å®‰è£…æ­¥éª¤

### å‰ç½®è¦æ±‚

- âœ… å·²å®‰è£… Raspberry Pi OS (Trixie/Bookworm 64-bit)
- âœ… å·²é…ç½® SSH å¹¶å¯é€šè¿‡ `rpi.local` è®¿é—®
- âœ… å·²è®¾ç½® SSH å¯†é’¥æ— å¯†ç ç™»å½•ï¼ˆæ¨èï¼‰

### ğŸš€ å¿«é€Ÿå¼€å§‹

åœ¨ **æœ¬åœ°ç”µè„‘**ï¼ˆéæ ‘è“æ´¾ï¼‰æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1ï¸âƒ£ å…‹éš†ä»“åº“
git clone https://github.com/yourusername/RPI-MediaPlayer.git
cd RPI-MediaPlayer

# 2ï¸âƒ£ åˆ›å»º SSH å¯†é’¥ï¼ˆå¦‚æœæ²¡æœ‰ï¼‰
mkdir -p rpi_keys
ssh-keygen -t ed25519 -f ./rpi_keys/id_rpi -C "player@rpi"
# æŒ‰ Enter è·³è¿‡å¯†ç ï¼ˆç”¨äºæ— å¯†ç ç™»å½•ï¼‰

# 3ï¸âƒ£ å°†å…¬é’¥å¤åˆ¶åˆ°æ ‘è“æ´¾
ssh-copy-id -i ./rpi_keys/id_rpi.pub player@rpi.local

# 4ï¸âƒ£ ç¼–è¾‘é…ç½®æ–‡ä»¶
nano config.ini
```

#### å…³é”®é…ç½®é¡¹ï¼š

```ini
[ssh]
host = rpi.local          # æ ‘è“æ´¾ä¸»æœºåæˆ– IP
user = player             # SSH ç”¨æˆ·å
key = ./rpi_keys/id_rpi   # ç§é’¥è·¯å¾„

[squeezelite]
name = RPI-Squeeze        # LMS æ’­æ”¾å™¨åç§°
server = 192.168.50.210   # LMS æœåŠ¡å™¨ IP

[airplay]
name = RPI-AirPlay        # AirPlay åç§°
port = 5000               # ç›‘å¬ç«¯å£

[bluetooth]
name = RPI-Bluetooth      # è“ç‰™è®¾å¤‡åç§°

[oled]
bus = 3                   # I2C æ€»çº¿ç¼–å·
address = 0x3C            # I2C åœ°å€
```

```bash
# 5ï¸âƒ£ è¿è¡Œè‡ªåŠ¨åŒ–å®‰è£…
./setup.sh
```

### â±ï¸ é¢„è®¡æ—¶é—´

| é˜¶æ®µ | æ—¶é—´ |
|------|------|
| ğŸ“¤ ä¸Šä¼ æ–‡ä»¶ | ~10 ç§’ |
| ğŸ”§ é˜¶æ®µ 1ï¼ˆç³»ç»Ÿé…ç½®ï¼‰ | ~2 åˆ†é’Ÿ + é‡å¯ï¼ˆ~1 åˆ†é’Ÿï¼‰|
| ğŸ”§ é˜¶æ®µ 2ï¼ˆæœåŠ¡å®‰è£…ï¼‰ | ~5 åˆ†é’Ÿ + é‡å¯ï¼ˆ~1 åˆ†é’Ÿï¼‰|
| **â±ï¸ æ€»è®¡** | **çº¦ 10-12 åˆ†é’Ÿ** |

---

## ğŸ”§ é…ç½®è¯´æ˜

### æ ¸å¿ƒé…ç½®ï¼ˆconfig.iniï¼‰

<details>
<summary>ğŸ“– ç‚¹å‡»å±•å¼€å®Œæ•´é…ç½®ç¤ºä¾‹</summary>

```ini
# ============================================
# SSH è¿æ¥
# ============================================
[ssh]
host = rpi.local          # æ ‘è“æ´¾ä¸»æœºåæˆ– IP
user = player             # SSH ç”¨æˆ·å
port = 22                 # SSH ç«¯å£
key = ./rpi_keys/id_rpi   # ç§é’¥è·¯å¾„

# ============================================
# ç³»ç»Ÿé…ç½®
# ============================================
[system]
timezone = America/Vancouver  # æ—¶åŒº
auto_update = yes            # æ˜¯å¦è‡ªåŠ¨æ›´æ–°ç³»ç»Ÿ

# ============================================
# Squeezelite (LMS æ’­æ”¾å™¨)
# ============================================
[squeezelite]
name = RPI-Squeeze           # æ’­æ”¾å™¨åç§°ï¼ˆæ˜¾ç¤ºåœ¨ LMS ä¸­ï¼‰
server = 192.168.50.210      # LMS æœåŠ¡å™¨ IP
device = default             # ALSA è®¾å¤‡ï¼ˆé€šå¸¸ç”¨ defaultï¼‰
args = -a 40:4:32:0 -b 500:5000  # å¯é€‰å‚æ•°ï¼ˆç¼“å†²ã€æ—¥å¿—ç­‰ï¼‰

# ============================================
# AirPlay
# ============================================
[airplay]
name = RPI-AirPlay           # AirPlay åç§°ï¼ˆæ˜¾ç¤ºåœ¨ iOS ä¸­ï¼‰
port = 5000                  # ç›‘å¬ç«¯å£
device = default             # ALSA è®¾å¤‡
initial_volume = 60          # åˆå§‹éŸ³é‡ï¼ˆ0-100ï¼‰

# ============================================
# è“ç‰™
# ============================================
[bluetooth]
name = RPI-Bluetooth         # è“ç‰™è®¾å¤‡åç§°
check_interval = 20          # è‡ªåŠ¨é…å¯¹æ£€æŸ¥é—´éš”ï¼ˆç§’ï¼‰

# ============================================
# WM8960 å£°å¡
# ============================================
[wm8960]
bus = 1                      # I2C æ€»çº¿ç¼–å·ï¼ˆé€šå¸¸æ˜¯ 1ï¼‰

# ============================================
# OLED æ˜¾ç¤ºå±
# ============================================
[oled]
width = 128                  # å±å¹•å®½åº¦
height = 64                  # å±å¹•é«˜åº¦
bus = 3                      # I2C æ€»çº¿ç¼–å·ï¼ˆé€šå¸¸æ˜¯ 3ï¼‰
sda_pin = 4                  # GPIO æ•°æ®å¼•è„š
scl_pin = 5                  # GPIO æ—¶é’Ÿå¼•è„š
address = 0x3C               # I2C åœ°å€ï¼ˆ0x3C æˆ– 0x3Dï¼‰

# ============================================
# è·¯å¾„é…ç½®
# ============================================
[paths]
# è¿œç¨‹å®‰è£…ç›®å½•å
remote_install_dir = installer

# åº”ç”¨æ ¹ç›®å½•å
app_base_dir = rpi-mediaplayer

# OLED è™šæ‹Ÿç¯å¢ƒè·¯å¾„
oled_venv_dir = .venv/oled

# AirPlay metadata ç®¡é“è·¯å¾„
metadata_pipe = /tmp/shairport-sync-metadata

# ============================================
# è¶…æ—¶é…ç½®ï¼ˆç§’ï¼‰
# ============================================
[timeouts]
# APT é”ç­‰å¾…è¶…æ—¶
apt_lock = 60

# PipeWire å°±ç»ªè¶…æ—¶
pipewire_ready = 30

# SSH è¿æ¥è¶…æ—¶
ssh_connect = 10

# é‡å¯ç­‰å¾…è¶…æ—¶
reboot_wait = 180

# é‡å¯è½®è¯¢é—´éš”
reboot_poll_interval = 5

# ============================================
# éŸ³é¢‘é…ç½®
# ============================================
[audio]
# ALSA ç¡¬ä»¶éŸ³é‡ï¼ˆ0-100ï¼‰
default_hw_volume = 95

# PipeWire Sink é»˜è®¤éŸ³é‡ï¼ˆ0-100ï¼‰
default_sink_volume = 100
```

</details>

### ğŸ”’ å®‰å…¨æ³¨æ„äº‹é¡¹

> **âš ï¸ æ°¸è¿œä¸è¦å°†ç§é’¥æäº¤åˆ° Gitï¼**
> 
> - `.gitignore` å·²é…ç½®å¿½ç•¥ `rpi_keys/` ç›®å½•
> - ç§é’¥ä»…ä¿å­˜åœ¨æœ¬åœ°ç”µè„‘
> - å¦‚éœ€å¤šå°ç”µè„‘éƒ¨ç½²ï¼Œæ‰‹åŠ¨å¤åˆ¶ç§é’¥æ–‡ä»¶

---

## ğŸ“Š ç³»ç»ŸæœåŠ¡

å®‰è£…å®Œæˆåï¼Œä»¥ä¸‹æœåŠ¡å°†è‡ªåŠ¨è¿è¡Œï¼š

| æœåŠ¡åç§° | ç±»å‹ | åŠŸèƒ½ | å¯åŠ¨å‘½ä»¤ |
|---------|------|------|---------|
| `pipewire` | ğŸ‘¤ ç”¨æˆ· | éŸ³é¢‘æœåŠ¡å™¨ | `systemctl --user status pipewire` |
| `squeezelite` | ğŸ‘¤ ç”¨æˆ· | LMS æ’­æ”¾å™¨ | `systemctl --user status squeezelite` |
| `shairport-sync` | ğŸ‘¤ ç”¨æˆ· | AirPlay æ¥æ”¶ | `systemctl --user status shairport-sync` |
| `oled` | ğŸ‘¤ ç”¨æˆ· | OLED æ˜¾ç¤º | `systemctl --user status oled` |
| `volume` | ğŸ‘¤ ç”¨æˆ· | éŸ³é‡æ§åˆ¶ | `systemctl --user status volume` |
| `bluetooth` | ğŸ”§ ç³»ç»Ÿ | è“ç‰™æœåŠ¡ | `systemctl status bluetooth` |
| `bluetooth-a2dp-autopair` | ğŸ”§ ç³»ç»Ÿ | è“ç‰™è‡ªåŠ¨é…å¯¹ | `systemctl status bluetooth-a2dp-autopair` |

### æŸ¥çœ‹æœåŠ¡æ—¥å¿—

```bash
# ç”¨æˆ·æœåŠ¡
journalctl --user -u squeezelite -f

# ç³»ç»ŸæœåŠ¡
journalctl -u bluetooth-a2dp-autopair -f
```

### æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€

```bash
# ä½¿ç”¨å†…ç½®çš„ç›‘æ§è„šæœ¬
./check_status.sh
```

---

## ğŸ® ä½¿ç”¨æŒ‡å—

### ğŸµ æ’­æ”¾éŸ³ä¹

#### æ–¹å¼ 1ï¼šLogitech Media Server (LMS)
1. åœ¨ LMS æœåŠ¡å™¨ä¸Šæ‰¾åˆ°æ’­æ”¾å™¨ `RPI-Squeeze`
2. é€‰æ‹©éŸ³ä¹å¹¶æ’­æ”¾
3. OLED æ˜¾ç¤ºå±ä¼šè‡ªåŠ¨æ˜¾ç¤ºæ›²ç›®ä¿¡æ¯

#### æ–¹å¼ 2ï¼šAirPlay
1. æ‰“å¼€ iPhone/iPad æ§åˆ¶ä¸­å¿ƒ
2. ç‚¹å‡» AirPlay å›¾æ ‡
3. é€‰æ‹© `RPI-AirPlay`
4. æ’­æ”¾éŸ³ä¹ï¼Œæ ‘è“æ´¾è‡ªåŠ¨æ¥æ”¶

#### æ–¹å¼ 3ï¼šè“ç‰™
1. æ‰“å¼€æ‰‹æœºè“ç‰™è®¾ç½®
2. æœç´¢å¹¶è¿æ¥ `RPI-Bluetooth`
3. æ— éœ€ PIN ç ï¼Œè‡ªåŠ¨é…å¯¹
4. æ’­æ”¾éŸ³ä¹

### ğŸ”Š éŸ³é‡æ§åˆ¶

**æ‰‹åŠ¨è°ƒèŠ‚ï¼š**

```bash
volume.sh up      # æé«˜éŸ³é‡
volume.sh down    # é™ä½éŸ³é‡
volume.sh set 75  # è®¾ç½®å›ºå®šéŸ³é‡
volume.sh mute    # é™éŸ³åˆ‡æ¢
volume.sh status  # æŸ¥çœ‹å½“å‰çŠ¶æ€
```

**è‡ªåŠ¨éŸ³é‡ï¼š**
- **AirPlay**ï¼šé€šè¿‡ iOS è®¾å¤‡ä¾§è¾¹æŒ‰é”®è°ƒèŠ‚
- **è“ç‰™**ï¼šé€šè¿‡æ’­æ”¾è®¾å¤‡éŸ³é‡é”®è°ƒèŠ‚
- **Squeezelite**ï¼šé€šè¿‡ LMS ç•Œé¢è°ƒèŠ‚

### ğŸ–¥ï¸ OLED æ˜¾ç¤ºè¯´æ˜

**æ˜¾ç¤ºå†…å®¹ï¼š**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ SQ: å‘¨æ°ä¼¦              â”‚  â† é¡¶éƒ¨ï¼šéŸ³æº + è‰ºæœ¯å®¶
â”‚ æ™´å¤© â–ºâ–ºâ–º               â”‚  â† ä¸­éƒ¨ï¼šæ›²ç›®ï¼ˆè‡ªåŠ¨æ»šåŠ¨ï¼‰
â”‚ ğŸ”Šâ”â”â”â”â”â”â”â”â”â”â”â” 75%    â”‚  â† åº•éƒ¨ï¼šéŸ³é‡æ¡ï¼ˆ2.5ç§’å¼¹çª—ï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**éŸ³æºæ ‡è¯†ï¼š**
- `SQ:` - Squeezelite (LMS)
- `AP:` - AirPlay
- `BT:` - è“ç‰™

**å±ä¿åŠŸèƒ½ï¼š**
- **5ç§’æ— æ“ä½œ** â†’ äº®åº¦é™ä½ï¼ˆ8/255ï¼‰
- **15åˆ†é’Ÿæ— æ“ä½œ** â†’ å±å¹•å…³é—­
- **æœ‰æ–°æ´»åŠ¨** â†’ è‡ªåŠ¨å”¤é†’

---

## ğŸ› ï¸ æ•…éšœæ’æŸ¥

é‡åˆ°é—®é¢˜ï¼Ÿè¯·æŸ¥é˜…è¯¦ç»†çš„æ•…éšœæ’æŸ¥æŒ‡å—ï¼š

### ğŸ“˜ [TROUBLESHOOTING.md](documents/TROUBLESHOOTING.md)

**å¸¸è§é—®é¢˜å¿«é€Ÿç´¢å¼•ï¼š**

| é—®é¢˜ç±»å‹ | å‚è€ƒç« èŠ‚ |
|---------|---------|
| ğŸ”Œ SSH è¿æ¥å¤±è´¥ | [éƒ¨ç½²å’Œè¿æ¥é—®é¢˜](documents/TROUBLESHOOTING.md#1-éƒ¨ç½²å’Œè¿æ¥é—®é¢˜) |
| ğŸ”Š å£°å¡æœªæ£€æµ‹åˆ° | [ç¡¬ä»¶æ£€æµ‹é—®é¢˜](documents/TROUBLESHOOTING.md#2-ç¡¬ä»¶æ£€æµ‹é—®é¢˜) |
| ğŸ–¥ï¸ OLED æ— æ˜¾ç¤º | [OLED æ˜¾ç¤ºé—®é¢˜](documents/TROUBLESHOOTING.md#6-oled-æ˜¾ç¤ºé—®é¢˜) |
| ğŸµ æœåŠ¡å¯åŠ¨å¤±è´¥ | [éŸ³é¢‘æœåŠ¡é—®é¢˜](documents/TROUBLESHOOTING.md#3-éŸ³é¢‘æœåŠ¡é—®é¢˜) |
| ğŸ”µ è“ç‰™æ— æ³•é…å¯¹ | [è“ç‰™é…å¯¹é—®é¢˜](documents/TROUBLESHOOTING.md#7-è“ç‰™é…å¯¹é—®é¢˜) |
| ğŸ”‡ éŸ³é‡è¿‡å°/è¿‡å¤§ | [éŸ³é‡æ§åˆ¶é—®é¢˜](documents/TROUBLESHOOTING.md#5-éŸ³é‡æ§åˆ¶é—®é¢˜) |

---

## ğŸ¤ è´¡çŒ®

æ¬¢è¿æäº¤ Issue å’Œ Pull Requestï¼

### å¼€å‘æŒ‡å—

- ğŸ“ ä»£ç é£æ ¼éµå¾ª ShellCheck è§„èŒƒ
- ğŸ“¦ æ–°å¢æ¨¡å—æ”¾åœ¨ `modules/` ç›®å½•
- ğŸ“ æ¨¡æ¿æ–‡ä»¶ä½¿ç”¨ `{{VARIABLE}}` å ä½ç¬¦
- âœ… æäº¤å‰æµ‹è¯•å®Œæ•´å®‰è£…æµç¨‹

---

## ğŸ“„ è®¸å¯è¯

MIT License - è‡ªç”±ä½¿ç”¨å’Œä¿®æ”¹

---

## ğŸ™ è‡´è°¢

- [Logitech Media Server](https://github.com/Logitech/slimserver) - å¼€æºéŸ³ä¹æœåŠ¡å™¨
- [Squeezelite](https://github.com/ralph-irving/squeezelite) - è½»é‡çº§éŸ³é¢‘æ’­æ”¾å™¨
- [Shairport-Sync](https://github.com/mikebrady/shairport-sync) - AirPlay éŸ³é¢‘æ¥æ”¶å™¨
- [PipeWire](https://pipewire.org/) - ç°ä»£éŸ³é¢‘æœåŠ¡å™¨
- [Luma.OLED](https://github.com/rm-hull/luma.oled) - Python OLED é©±åŠ¨åº“

---

## ğŸ“® è”ç³»æ–¹å¼

- **é—®é¢˜åé¦ˆ**ï¼š[GitHub Issues](https://github.com/yourusername/RPI-MediaPlayer/issues)
- **è®¨è®ºäº¤æµ**ï¼š[GitHub Discussions](https://github.com/yourusername/RPI-MediaPlayer/discussions)

---

<div align="center">

**ğŸ‰ äº«å—æ‚¨çš„å¤šåŠŸèƒ½åª’ä½“æ’­æ”¾å™¨ï¼**

Made with â¤ï¸ by the RPI MediaPlayer Team

</div>
